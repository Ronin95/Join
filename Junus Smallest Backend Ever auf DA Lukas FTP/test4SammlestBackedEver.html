<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test4SammlestBackedEver</title>
    <script src="mini_backend.js"></script>

    <script>
        setURL('https://lukas-erdmanski.developerakademie.net/M10alone/M10alone-Join/smallest_backend_ever-master');
        let users = [];

        /* Das ist eine ansychrone Funktion. D.h. es wird gewartet bis diese Funktion fertig ist: 
        in diesem Fall bis die Anfrage an den Server fertig ist (wo ein JSON vom Server heruntergeladen wird).
        Erst wenn dies fertig ist, wird der JSON in n채chsten Schritten verarbeitet: z.B. geparst und der Variable users zugewiesen, */
        async function init() {
            /* F체hrt und WARTET bis die Fuktion Herunterladen des Strings (value von gew채hltem key) vom Server fertig ist. */
            await downloadFromServer();
            usersAsString = backend.getItem('users');
            /* Konvertiert String vom Server in JSON */
            users = JSON.parse(usersAsString) || []; /* || [] bedeutet: wenn noch keine Variable users auf dem Server exisitert, wird Sie mit einem leeren Array deklariert. */

            /* Zeigt der String an */
            document.getElementById('usersContainerFromBackendServer').innerHTML = usersAsString;
        }

        
        function addUser() {
            /* Added User zuerst zum lokalen Array users */
            users.push(username.value);
            /* Konvertiert Array ussers in String */
            let usersAsString = JSON.stringify(users);
            /* Setzt den konvertierten users String auf den Backend Server */
            backend.setItem('users', usersAsString);

            /* Zeigt alle users vom String usersAsString im Div Container */
            document.getElementById('usersContainerFromBackendServer').innerHTML = usersAsString;
            /* Leert das Input Feld nach dem Hinzuf체gen. */
            username.value = "";
        }
    </script>
</head>

<body onload="init()">
    <input type="text" id="username" placeholder="type username to add it to the backend server"
        style="width: 300px;"><br>
    <button onclick="addUser()">Add User <br> to Junus - Smallest Backer Ever Server</button>

    <div id="usersContainerFromBackendServer">

    </div>

</body>

</html>